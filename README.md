## baseline

ååé‡ã€å»¶è¿Ÿã€è·¯çº¿æˆæœ¬ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡æ‹Ÿï¼ŒåŸºæœ¬æŒ‰ç…§é¢˜é¢åšçš„ã€‚

```
src
â”œâ”€â”€ base.hpp åŸºæœ¬å®šä¹‰
â”œâ”€â”€ eval.hpp å¤šç‰ˆæœ¬è¯„ä¼°æ–¹å¼
â”œâ”€â”€ event.hpp äº‹ä»¶å®šä¹‰
â”œâ”€â”€ log.cpp æ—¥å¿— ğŸ“’
â”œâ”€â”€ log.hpp
â”œâ”€â”€ main.cpp æ ¸å¿ƒæµ‹è¯•ç‚¹
â”œâ”€â”€ rust.hpp é€šç”¨å‡½æ•° ğŸ¦€
â”œâ”€â”€ sim.cpp ä¸–ç•Œ
â”œâ”€â”€ sim.hpp
â”œâ”€â”€ strategy
â”‚Â Â  â”œâ”€â”€ v1.cpp ç¬¬ä¸€å¤§ç‰ˆæœ¬ç­–ç•¥å›¾
â”‚Â Â  â”œâ”€â”€ v1.hpp
â”‚Â Â  â”œâ”€â”€ v2.cpp ç¬¬äºŒå¤§ç‰ˆæœ¬ç­–ç•¥å›¾
â”‚Â Â  â”œâ”€â”€ v2.hpp
â”‚Â Â  â”œâ”€â”€ v3.cpp ç¬¬ä¸‰å¤§ç‰ˆæœ¬ç­–ç•¥å›¾
â”‚Â Â  â””â”€â”€ v3.hpp
â”œâ”€â”€ strategy.cpp ç­–ç•¥é€šç”¨å‡½æ•°
â””â”€â”€ strategy.hpp

data
â””â”€â”€ data_gen.py # ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®

UI
â”œâ”€â”€ README.md
â””â”€â”€ UI.py # å¯è§†åŒ–

third_party/
â”œâ”€â”€ doctest # å•å…ƒæµ‹è¯•
â””â”€â”€ fmt # æ ¼å¼åŒ–æ—¥å¿—
```

## ç³»ç»Ÿè¯„ä¼°è®¾è®¡

æˆ‘ä»¬æœ‰å¤šä¸ªç‰ˆæœ¬çš„è¿è¾“ç­–ç•¥å’Œè¯„ä¼°ç­–ç•¥ã€‚æˆ‘ä»¬æ¯”è¾ƒæ»¡æ„è¯„ä¼°å‡½æ•°çš„æ˜¯ `V1`ï¼š

```
è¿è¾“æˆæœ¬
å¿«åŒ…è£¹è¿è¾“æ—¶é—´ _ 1ï¼Œè‹¥è¶…è¿‡ 24hï¼Œç«‹å³å¢åŠ  50ï¼Œæ¯å°æ—¶å¢åŠ  3
æ…¢åŒ…è£¹è¿è¾“æ—¶é—´ _ 1ï¼Œè‹¥è¶…è¿‡ 72hï¼Œç«‹å³å¢åŠ  50ï¼Œæ¯å°æ—¶å¢åŠ  3
```

## è¿è¡Œæ–¹æ³•

https://github.com/julyfun/ds-proj2

```
git clone git@github.com:julyfun/ds-proj2.git
cd ds-proj2
git submodule update --init # è·å– fmt åº“
mkdir build
cd build
cmake ..
make -j8
```

ç¼–è¯‘å®Œæˆï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰è‹¥å¹²æµ‹è¯•ç‚¹ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªæµ‹è¯•ã€‚

```
# æµ‹è¯•ç®€å•è·¯å¾„ï¼ˆè§ main.cpp ä¸­çš„ `TEST_CASE("simple")`ï¼‰
./run --dt-test-case=simple -s`
# æµ‹è¯• dijkstra ç®—æ³•æ˜¯å¦æ­£ç¡®
./run --dt-test-case="dijkstra*" -s`
# ç”Ÿæˆè¾ƒå¤§æµ‹è¯•æ•°æ®
cd ../data
python3 data_gen.py
cd ../build
# æµ‹è¯•è¯¥æ•°æ®ä¸‹çš„æ‰€æœ‰ç®—æ³•æ€§èƒ½
./run --dt-test-case="main-pk" -s 1>/dev/null
./run --dt-test-case="smart-pk" -s 1>/dev/null
```

è¾“å‡ºå½¢å¦‚ï¼š

```
Eval V0 ====================
    Run 1428.923541ms spent for simulation # è¯„ä¼°å‡½æ•°ç‰ˆæœ¬ V0ï¼Œå†³ç­–ç‰ˆæœ¬ V1 çš„è¿è¡Œæ—¶é—´
     V1 cost: 136014.03769810183 events: 84794 # è¯„ä¼°æ€»ä»£ä»·ä»¥åŠäº‹ä»¶æ•°é‡
    Run 1395.185709ms spent for simulation # è¯„ä¼°å‡½æ•°ç‰ˆæœ¬ V0ï¼Œå†³ç­–ç‰ˆæœ¬ V1B çš„è¿è¡Œæ—¶é—´..
    V1B cost: 133819.6372244197 events: 85308
    Run 420.290625ms spent for simulation
     V2 cost: 134286.83741917566 events: 15107
    Run 418.573625ms spent for simulation
    V2B cost: 116403.34815027067 events: 15092
    Run 438.005ms spent for simulation
     V3 cost: 125184.70475334405 events: 15187
Eval V1 ====================
    Run 1263.151417ms spent for simulation
     V1 cost: 272445.42059001856 events: 84794
    Run 1324.025458ms spent for simulation
    V1B cost: 268297.8841774791 events: 85308
    Run 422.177125ms spent for simulation
     V2 cost: 269655.11557886034 events: 15107
    Run 418.104ms spent for simulation
    V2B cost: 275809.0009622771 events: 15092
    Run 434.665792ms spent for simulation
     V3 cost: 294798.43371186795 events: 15187
```

## Roadmap

https://docs.qq.com/sheet/DWHJOZHRLZE9YaUpt?tab=BB08J2

## å­¦ä¹ èµ„æ–™

- äº‹ä»¶é©±åŠ¨ç¼–ç¨‹: https://stdcxx.apache.org/doc/stdlibug/11-3.html

## ç­–ç•¥è®¾è®¡

### V1

![](doc/img/v1.svg)

é—®é¢˜:

- åŒä¸€ä¸ªç«™ç‚¹çš„ TryProcess å¯èƒ½ä¼šå¹³æ–¹å¢é•¿ï¼Œlog çˆ†ç‚¸

### V1.a (deprecated)

è®°å½•å…¨å±€ floydï¼Œä¸”è®°å½•æ˜¯å¦é¢„å®šäº† TryProcessOneã€‚

- é™æ€

### V1.b

`dijkstra enhanced` å½“æœ‰ç«™ç‚¹ buffer æ¯”è¾ƒæ»¡çš„æ—¶å€™ï¼Œä¸é€‰æ‹©è¯¥ç«™ç‚¹ã€‚è‹¥ç”Ÿæˆè·¯å¾„å¤±è´¥ï¼Œåˆ™é‡‡ç”¨åŸå§‹ `dijkstra`

ref: https://www.mdpi.com/2071-1050/14/16/10367

- åŠ¨æ€

### V2

- è®°å½• package çš„å»å‘ï¼Œåœ¨ dijkstra ä¸­ä¼°è®¡ç­‰å¾…æ—¶é—´ï¼ŒåŠ å…¥ä»£ä»·ä¼°è®¡ä¸­ã€‚å¯è®¾å®šçº¿æ€§å‚æ•°æ¥ä¼°è®¡æœªæ¥ä»£ä»·ï¼Œå‡å®šåˆ°è¾¾æ—¶é—´ä¹‹å‰ç«™ç‚¹ç–¯ç‹‚å¤„ç†åŒ…è£¹
- ä¼˜åŒ–ç«™ç‚¹ Try å¤±è´¥åæ·»åŠ  Try çš„ç­–ç•¥ï¼Œæ·»åŠ  ok é”ï¼Œå‡å°‘äº‹ä»¶æ•°é‡

### V2.b

- ä¼˜å…ˆå– EXPRESS

é—®é¢˜ï¼š

- è·‘çš„å¤ªæ…¢, 1152 è¡Œæ•°æ®è·‘äº† 2~3sï¼ˆå¼€ O2 ä»¥å 600ms ~ 900msï¼‰
- ä¼šæœ‰æ­»åŒ…è£¹

### V3

- åŒæ ·åˆ©ç”¨ v2 çš„ cache è®¡ç®—æœ€çŸ­è·¯ï¼Œä½†åŒæ—¶è®¡ç®—â€œå‡è®¾ç«‹å³å‘é€æ­¤åŒ…è£¹ï¼Œåˆ™é€è¾¾æ—¶é—´è·ç¦» DDL è¿˜æœ‰å¤šä¹…â€ï¼Œç«™ç‚¹è´Ÿè´£å‘é€ç¦» DDL æœ€è¿‘çš„åŒ…è£¹ã€‚
- é¿å…äº†ä¼˜å…ˆ STANDARD æ­»åŒ…è£¹

### V4

å®šæ—¶é‡‡æ ·ï¼Œç”¨æ»¤æ³¢å™¨è®°å½•å†å²ç«™ç‚¹çš„æ‹¥å µæƒ…å†µï¼Œåˆ¤æ–­æ‹¥å µçš„å¯èƒ½æ€§ã€‚

## è¯„ä¼°å‡½æ•°

### V0

```

è¿è¾“æˆæœ¬ + å¿«åŒ…è£¹è¿è¾“æ—¶é—´ _ 3 + æ…¢åŒ…è£¹è¿è¾“æ—¶é—´ _ 1

```

é—®é¢˜ï¼šä¸èƒ½é˜²æ­¢æ­»åŒ…è£¹

### V1

```
è¿è¾“æˆæœ¬
å¿«åŒ…è£¹è¿è¾“æ—¶é—´ _ 1ï¼Œè‹¥è¶…è¿‡ 24hï¼Œç«‹å³å¢åŠ  50ï¼Œæ¯å°æ—¶å¢åŠ  3
æ…¢åŒ…è£¹è¿è¾“æ—¶é—´ _ 1ï¼Œè‹¥è¶…è¿‡ 72hï¼Œç«‹å³å¢åŠ  50ï¼Œæ¯å°æ—¶å¢åŠ  3
```
